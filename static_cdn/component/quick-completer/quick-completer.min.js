!function(a,b,c){"use strict";var d=function(a){var e,f,g,h,i,c=a.parse().getOptions(),d={onError:null,onSelect:null};e=function(){if(g("inputElement").data("quick-completer-debug-noise")){var a=[].slice.apply(arguments);a.unshift("[quick-completer debug noise]"),a.unshift((new Date).toString()),console.debug.apply(console,a)}},f=function(a){if(e("): Ops!",arguments),"function"==typeof d.onError){var b=[].slice.apply(arguments);b.unshift(a),d.onError.apply(null,b)}throw new Error(a)},g=function(a){return c.hasOwnProperty(a)?c[a]:void f('"'+a+'" not found in "_options"')},h=function(){"object"==typeof g("inputElement")&&g("inputElement").jquery||f('Op\xe7\xe3o "inputSelector" inv\xe1lida!'),"object"==typeof g("hiddenElement")&&g("hiddenElement").jquery||f('Op\xe7\xe3o "hiddenSelector" inv\xe1lida!'),"string"!=typeof g("inputSelector")&&f('Op\xe7\xe3o "inputSelector" inv\xe1lida!'),"string"!=typeof g("hiddenSelector")&&f('Op\xe7\xe3o "hiddenElement" inv\xe1lida!'),"text"!==g("inputElement").attr("type")&&f('Informe o elemento "<input type="text" />"'),"hidden"!==g("hiddenElement").attr("type")&&f('Informe o elemento escondido "<input type="hidden" />"');var a,b;for(a in g("extraValuesFields"))g("extraValuesFields").hasOwnProperty(a)&&(b=g("extraValuesFields")[a],"object"==typeof b&&b.jquery||f('Op\xe7\xe3o "extraValuesFields" inv\xe1lida!'))},i=function(){var a={},c=function(a){var b=g("url").protocol+"://"+g("url").host+":"+g("url").port+"?",c={_stoken:g("aclToken"),_method:"get",_command:"_search",_qparam:{q:a,l:g("itemsToDisplay"),i:g("schemaToSearch"),dt:g("tableToSearch"),of:g("resultFields")}};return e("Vai requisitar",b,c),b+JSON.stringify(c)};a["bootstrap-v2.x"]=function(){var i,j,a={},h="quick-completer-controled-abortation",k=function(){var a=g("inputElement").siblings(".help-inline:first");return a.length||(a=b("<span />").addClass("help-inline"),g("inputElement").parent().append(a)),a},l=function(){var a,b;for(a in g("extraValuesFields"))g("extraValuesFields").hasOwnProperty(a)&&(b=g("extraValuesFields")[a],b.val(""));g("hiddenElement").val(""),k().empty(),g("inputElement").data("quick-completer-selected-value",""),g("inputElement").data("quick-completer-selected-text",""),g("inputElement").parents(".control-group").removeClass("error warning")},m=function(b){var c=a[b][g("textKey")],f=a[b][g("valueKey")];e("Selecionado",c,f),g("inputElement").data("quick-completer-selected-text",c),g("inputElement").data("quick-completer-selected-value",f),g("inputElement").val(c),g("hiddenElement").val(f);var h,i;for(h in g("extraValuesFields"))g("extraValuesFields").hasOwnProperty(h)&&(i=g("extraValuesFields")[h],i.val(a[b][h]));"function"==typeof d.onSelect&&d.onSelect.apply(null,[a[b]])},n=function(){e("Antes de processar o resultado",g("inputElement"),g("hiddenElement")),l(),k().html('<div class="bubbling mini"><span></span><span></span><span></span></div>')},o=function(a){e("Depois de processar o resultado",g("inputElement"),g("hiddenElement")),l(),a||""===b.trim(g("inputElement").val())||(k().text("Nenhum registro encontrado"),g("inputElement").parents(".control-group").addClass("warning"))},p=function(a){l(),k().text(a),g("inputElement").parents(".control-group").addClass("error"),f(a)},q=function(b){e("Processando o resultado",b);var c=[];if(a={},"object"==typeof b&&b)if(b.error)p(b.error);else if(b.content){var f,h,i,d=b.content;for(h in d)d.hasOwnProperty(h)&&(i=d[h],f=i[g("textKey")],a[f]=i,c.push(f))}else p("Erro na formata\xe7\xe3o do retorno da informa\xe7\xe3o do autocomplete");else p("Erro ao receber a informa\xe7\xe3o do autocomplete");return e("Itens do autocomplete",a,c),{visibleItens:c,total:b.total||0}},r=function(){e("Delega\xe7\xe3o de eventos",g("inputElement"),g("hiddenElement"));var a=function(a){var c=b.trim(g("inputElement").data("quick-completer-selected-text")),d=b.trim(g("inputElement").data("quick-completer-selected-value")),f=b.trim(g("inputElement").val()),h=b.trim(g("hiddenElement").val());e(a,'\n"selectedText"',c,'"selectedValue"',d,'"inputText"',f,'"hiddenValue"',h),(""===h||""===d||h!==d||f!==c)&&(f="",g("inputElement").val(f),e("Zera o valor do campo")),""===f&&(h="",l(),e("Zera o valor do campo oculto (e os extras, se tiver)"))};g("inputElement").bind({blur:function(){a("Perdeu o foco")},focus:function(){a("Ganhou foco")}})};g("inputElement").typeahead({minLength:g("minLengthToSearch"),items:g("itemsToDisplay"),updater:function(a){return m(a),a},matcher:function(){return!0},sorter:function(a){return a},highlighter:function(a){var b=function(a){var b,c=a.toLowerCase(),d={a:"[\xe0\xe1\xe2\xe3\xe4\xe5]",e:"[\xe8\xe9\xea\xeb]",i:"[\xec\xed\xee\xef]",o:"[\xf2\xf3\xf4\xf5\xf6]",u:"[\xf9\xfa\xfb\u0171\xfc]",y:"[\xfd\xff]",c:"\xe7",n:"\xf1","-":"\u2013"};for(b in d)d.hasOwnProperty(b)&&(c=c.replace(new RegExp(d[b],"img"),b));return c=c.replace(/\s+/g," ")};try{var c=b(a),d=b(this.query),f=c.indexOf(d);if(-1===f)return'<span title="Resultado aproximado">'+a+"</span>";var g=d.length,h="("+a.substr(f,g)+")",i=new RegExp(h,"img");return a.replace(i,"<strong>$1</strong>")}catch(j){return e("(Destacador) ops: Exception!'",j,a),a}},source:function(a,d){return a=b.trim(a),a&&(n(),i&&(e("Reinicia o aguardo para procurar"),clearTimeout(i)),j&&(e("Aborta a requisi\xe7\xe3o anterior"),j.abort(h)),e("Registrando o aguardo para procurar",a),i=setTimeout(function(){e("Procurando\u2026",a),j=b.getJSON(c(a)),j.success(function(a){var b=q(a);o(b.total),d(b.visibleItens)}),j.fail(function(a){a.statusText!==h?p("N\xe3o foi poss\xedvel recuperar as informa\xe7\xf5es do servidor do autocomplete"):e("Aborto controlado")})},g("delayInMillisecondsToSearch"))),[]}}),r()},a[g("style")]()},this.init=function(){var a=function(){return"             _      _                                   _      _            \n  __ _ _   _(_) ___| | __      ___ ___  _ __ ___  _ __ | | ___| |_ ___ _ __ \n / _` | | | | |/ __| |/ /____ / __/ _ \\| '_ ` _ \\| '_ \\| |/ _ \\ __/ _ \\ '__|\n| (_| | |_| | | (__|   <_____| (_| (_) | | | | | | |_) | |  __/ ||  __/ |   \n \\__, |\\__,_|_|\\___|_|\\_\\     \\___\\___/|_| |_| |_| .__/|_|\\___|\\__\\___|_|   \n    |_|                                          |_|                        \n"};h(),i(),e("\n\n"+a(),c)},this.onSelect=function(a){e("Registrando o callback de selecionado"),d.onSelect=a},this.onError=function(a){e("Registrando o callback de erro"),d.onError=a}};d.DSN=function(a){function e(a){var e=function(a,b){var c=d.config[a][b];if(!c)throw new Error('Configura\xe7\xe3o "'+a+"="+b+'" n\xe3o encontrada no arquivo "component/quick-completer/quick-completer-config.js"');return c},f={debugNoise:!1,style:"bootstrap-v2.x",input:"",inputElement:b(),inputSelector:"",hiddenElement:b(),hiddenSelector:"",schemaToSearch:"-",tableToSearch:"-",minLengthToSearch:3,itemsToDisplay:10,delayInMillisecondsToSearch:500,textKey:"text",valueKey:"value",extraValues:[],extraValuesFields:{},resultFields:[],aclToken:"",env:"production",url:{protocol:"",host:"",port:0}},g={},h=function(){if(g=b.extend(f,a),g.aclToken=e("acl","token"),g.env&&(g.url.protocol=e("env",g.env).protocol,g.url.host=e("env",g.env).host,g.url.port=e("env",g.env).port,delete g.env),g.input){var d={string:function(){g.inputSelector=g.input},object:function(){g.inputElement=g.input}},h=typeof g.input;d.hasOwnProperty(h)&&d[h](),delete g.input}if(g.type){var i,j=e("type",g.type).extraValues;for(i in j)j.hasOwnProperty(i)&&g.extraValues.push(j[i]);g.schemaToSearch=e("type",g.type).index,g.tableToSearch=e("type",g.type).documentType,g.textKey=e("type",g.type).textKey,g.valueKey=e("type",g.type).valueKey,delete g.type}if(g.inputSelector.length&&"string"==typeof g.inputSelector&&(g.inputElement=b(g.inputSelector)),g.hiddenSelector.length&&"string"==typeof g.hiddenSelector&&(g.hiddenElement=b(g.hiddenSelector)),g.inputElement.length&&"object"==typeof g.inputElement){g.inputSelector=g.inputElement.selector;var k=g.inputElement.data("quick-completer-min-lenght-to-search"),l=g.inputElement.data("quick-completer-delay-in-milliseconds-to-search"),m=g.inputElement.data("quick-completer-items-to-display"),n=g.inputElement.data("quick-completer-schema-to-search"),o=g.inputElement.data("quick-completer-table-to-search");k&&(g.minLengthToSearch=k),l&&(g.delayInMillisecondsToSearch=l),m&&(g.itemsToDisplay=m),n&&(g.schemaToSearch=n),o&&(g.tableToSearch=o)}if(g.hiddenElement.length&&"object"==typeof g.hiddenElement)g.hiddenSelector=g.hiddenElement.selector;else{var p=g.inputElement.attr("id");g.hiddenElement=b("#"+p+"_hidden")}var q=g.inputElement.data("quick-completer-debug-noise");if(q===c?g.inputElement.data("quick-completer-debug-noise",g.debugNoise):g.debugNoise=q,g.resultFields=g.extraValues.slice(0),g.resultFields.unshift(g.valueKey),g.resultFields.unshift(g.textKey),g.extraValues.length){var r,s,t={};for(r in g.extraValuesFields)g.extraValuesFields.hasOwnProperty(r)&&(s=g.extraValuesFields[r],"string"==typeof s&&(s=b(s)),t[r]=s);g.extraValuesFields=t}};this.parse=function(){return h(),this},this.getOptions=function(){return g}}return new e(a)},a.QuickCompleter=d}(window,jQuery);